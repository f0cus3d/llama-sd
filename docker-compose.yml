# docker compose used for testing the application

version: "3.5"

services:
  llama-server-dev:
    build: 
      context: ./server
      dockerfile: ./Dockerfile
    container_name: llama-server-dev
    hostname: llama-server-dev
    ports:
      - "80:80"
    environment:
      - APP_HOST=0.0.0.0
      - APP_PORT=80
      - APP_GROUP=none
      - APP_KEEPALIVE=86400
      - APP_VERBOSE=True
      - TZ=America/Los_Angeles


  llama-client-dev1:
    build: 
      context: ./client
      dockerfile: ./Dockerfile
    network_mode: host
    container_name: llama-client-dev1
    hostname: llama-client-dev1
    environment:
      - LLAMA_SERVER=http://10.1.0.107
      - LLAMA_KEEPALIVE=300
      - LLAMA_GROUP=default
      - "LLAMA_TAGS=[source: dev1, name: ONE]"
      - APP_VERBOSE=True
      - TZ=America/Los_Angeles
    depends_on:
      - "llama-server-dev"

  llama-probe-dev1:
    build: 
      context: ./llama-probe
      dockerfile: ./Dockerfile
    ports:
      - "8100:8100/tcp"
      - "8100:8100/udp"
    container_name: llama-probe-dev1
    hostname: llama-probe-dev1
    environment:
      - LLAMA_SERVER=http://10.1.0.107
      - LLAMA_GROUP=default
    depends_on:
      - "llama-client-dev1"
